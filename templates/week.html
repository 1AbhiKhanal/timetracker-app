{% extends "base.html" %}
{% block content %}
<div class="card">
  <div class="card-header">
    <h3 class="mb-0"><i class="fas fa-calendar-week"></i> Weekly Summary</h3>
  </div>
  <div class="card-body">
    {% if is_locked %}
      <div class="alert alert-warning">
        <i class="fas fa-lock"></i> This week is locked. Edits require admin unlock.
      </div>
    {% endif %}
    <div class="row">
      <div class="col-md-4">
        <p class="text-muted"><i class="fas fa-calendar"></i> Week Period</p>
        <p class="time-display" style="font-size: 1.2rem;">{{ w_start.strftime("%d/%m") }} - {{ w_end.strftime("%d/%m/%Y") }}</p>
      </div>
      <div class="col-md-4">
        <div class="stat-box success">
          <h5><i class="fas fa-briefcase"></i> Total Worked</h5>
          <div class="value">{{ weekly_work }}</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stat-box">
          <h5><i class="fas fa-coffee"></i> Total Breaks</h5>
          <div class="value">{{ weekly_break }}</div>
        </div>
      </div>
    </div>
    
    <div class="row mt-3">
      <div class="col-12">
        <div class="stat-box warning">
          <h5><i class="fas fa-flag"></i> Remaining to 48h</h5>
          <div class="value">{{ remaining }}</div>
        </div>
      </div>
    </div>
    {% if weekly_limit %}
      <div class="row mt-3">
        <div class="col-12">
          <div class="stat-box {% if over_limit %}warning{% else %}success{% endif %}">
            <h5><i class="fas fa-user-check"></i> Weekly Limit ({{ weekly_limit }}h)</h5>
            <div class="value">
              {% if over_limit %}
                Over limit
              {% else %}
                {{ remaining_limit }}h remaining
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</div>

<div class="card">
  <div class="card-header">
    <h5 class="mb-0"><i class="fas fa-list"></i> Daily Breakdown</h5>
  </div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead>
          <tr>
            <th><i class="fas fa-calendar-alt"></i> Date</th>
            <th><i class="fas fa-sign-in-alt"></i> In</th>
            <th><i class="fas fa-utensils"></i> Lunch</th>
            <th><i class="fas fa-moon"></i> Dinner</th>
            <th><i class="fas fa-sign-out-alt"></i> Out</th>
            <th><i class="fas fa-coffee"></i> Breaks</th>
            <th><i class="fas fa-briefcase"></i> Worked</th>
          </tr>
        </thead>
        <tbody>
          {% if rows %}
            {% for r in rows %}
              <tr>
                <td><strong>{{ r.date }}</strong></td>
                <td>{{ r.clock_in }}</td>
                <td>{{ r.lunch }}</td>
                <td>{{ r.dinner }}</td>
                <td>{{ r.clock_out }}</td>
                <td><span class="badge bg-warning">{{ r.breaks }}m</span></td>
                <td><span class="badge bg-success">{{ r.worked }}m</span></td>
              </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="7" class="text-center text-muted py-4">
                <i class="fas fa-inbox"></i> No entries for this week
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<a href="/dashboard" class="btn btn-primary w-100 mt-3">
  <i class="fas fa-arrow-left"></i> Back to Dashboard
</a>
{% endblock %}
